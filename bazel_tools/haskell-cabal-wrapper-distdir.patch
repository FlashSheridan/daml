diff --git a/haskell/private/cabal_wrapper.py.tpl b/haskell/private/cabal_wrapper.py.tpl
index be8dafcd..576b1459 100755
--- a/haskell/private/cabal_wrapper.py.tpl
+++ b/haskell/private/cabal_wrapper.py.tpl
@@ -120,10 +120,16 @@ def tmpdir():
     # Executables are placed into `<distdir>/build/<package-name>/<binary>`.
     # Libraries are placed into `<distdir>/build/<library>`. I.e. there is an
     # extra subdirectory for libraries.
-    if component.startswith("exe:"):
-        distdir = tempfile.mkdtemp(dir=os.path.dirname(os.path.dirname(pkgroot)))
+    #
+    # On Windows we don't do dynamic linking and prefer shorter paths to avoid
+    # exceeding `MAX_PATH`.
+    if "%{is_windows}" == "True":
+        distdir = tempfile.mkdtemp()
     else:
-        distdir = tempfile.mkdtemp(dir=os.path.dirname(pkgroot))
+        if component.startswith("exe:"):
+            distdir = tempfile.mkdtemp(dir=os.path.dirname(os.path.dirname(pkgroot)))
+        else:
+            distdir = tempfile.mkdtemp(dir=os.path.dirname(pkgroot))
     try:
         yield distdir
     finally:
